{"remainingRequest":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\src\\components\\xz\\Cart.vue?vue&type=style&index=0&id=1a6f731a&scoped=true&lang=css","dependencies":[{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\src\\components\\xz\\Cart.vue","mtime":1567411906375},{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907988000},{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"D:\\Web1905\\vue2\\vueui\\day01\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\np,h4{\n  margin:0;\n}\n.page_cart h2{\n  margin:0;\n  padding:1rem 0.5rem;\n  background-color: lightcoral;\n  font-weight: normal;\n}\n.cart_list{\n  padding: 0.2rem;\n}\n.cart_list nav{\n  width:100%;\n  height:2rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  background-color:#eee;\n \n}\n.cart_list .pro{\n  width:40%;\n}\n.check{\n  width:13%;\n}\n.price{\n  width:20%;\n}\n.delete{\n  width:14%;\n  background-color:transparent;\n}\n.cart_list .cart_item{\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  margin-bottom: 0.2rem;\n  padding:0.3rem 0;\n  background-color: #FFF4E8;\n}\n.bottom{\n display: flex;\n justify-content: space-between;\n align-items: center;\n position: fixed;\n bottom: 0;\n width:98%;\n background-color: #fff;\n}\n",{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src\\components\\xz","sourcesContent":["<template>\r\n  <div class=\"page_cart\">\r\n    <h2>购物车</h2>\r\n    <div class=\"cart_list\">\r\n      <nav>\r\n          <label class=\"check\"><input type=\"checkbox\" v-model=\"allchecked\" @change=\"checkAllchange\"> 全选</label> \r\n          <span class=\"pro\">商品</span>\r\n          <span class=\"price\">单价</span>\r\n          <!-- <span class=\"price\">数量</span> -->\r\n          <span class=\"delete\">操作</span>\r\n      </nav>\r\n      <div class=\"cart_item\" v-for=\"(item,index) of cart_list\" :key=\"index\" @change=\"curChange\" >\r\n        <label class=\"check\">\r\n          <input type=\"checkbox\" v-model=\"item.isChecked\">\r\n        </label>\r\n          <h4 class=\"pro\">{{item.lname}}</h4>\r\n          <p class=\"price\">￥{{item.price.toFixed(2)}}</p>\r\n          <div class=\"delete\">\r\n            <mt-button @click=\"del(item.id)\" size=\"small\" :data-id=\"item.id\">删除</mt-button>\r\n          </div>\r\n      </div>\r\n      <div style=\"height:2rem\"></div>\r\n      <div class=\"bottom\">\r\n        <mt-button size=\"small\" @click=\"delAll\">清空购物车</mt-button>\r\n        <mt-button size=\"small\" @click=\"del(someId)\">删除指定商品</mt-button>\r\n        <span>总计:¥{{total}}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data(){\r\n    return{\r\n      cart_list:[],\r\n      allchecked:false\r\n    }\r\n  },\r\n  methods:{\r\n    loadMore(){\r\n      // 获取当前用户的购物车列表\r\n    (async ()=>{\r\n      var res=await this.axios.get(\"carts\");\r\n      console.log(res.data);\r\n      if(res.data.code==-1){\r\n        this.$messagebox(\"\",\"请登录\").then((res)=>{\r\n          this.$router.push('/Login');\r\n        });\r\n      }else if(res.data.code==1){\r\n        for (const c of res.data.data) {\r\n          c.isChecked=false;\r\n        }\r\n        this.cart_list=res.data.data;\r\n        console.log(res.data.data);\r\n      }else{\r\n        this.cart_list=[];\r\n      }\r\n    })();\r\n    },\r\n    checkAllchange(){\r\n      for (const c of this.cart_list) {\r\n        c.isChecked=this.allchecked;\r\n      }   \r\n    },\r\n    curChange(e){\r\n      if(e.target.nodeName==\"INPUT\"){\r\n        if(this.cart_list.filter(elem=>elem.isChecked).length==this.cart_list.length){\r\n          this.allchecked=true;\r\n        }else{\r\n          this.allchecked=false;\r\n        }\r\n      }\r\n    },\r\n    del(myId){\r\n      if(myId.length==0){\r\n        this.$toast(\"没有选中的商品\");\r\n        return;\r\n      }\r\n      console.log(myId);\r\n    // this.$messagebox.confirm(\"\",`确定删除这件商品吗?`).then(res=>{\r\n      (async ()=>{\r\n        try {\r\n          await this.$messagebox.confirm(\"\",`确定删除吗?`);\r\n          var res=await this.axios.get(\"delItem\",{\r\n            params:{\r\n              // id:e.target.dataset.id\r\n              id:myId\r\n            }\r\n          });\r\n          console.log(res.data);\r\n          if(res.data.code==-2){\r\n            this.$messagebox(\"\",\"请登录\").then(res=>{\r\n              this.$router.push('/Login');\r\n            });\r\n          }else if(res.data.code==1){\r\n            this.loadMore();\r\n            this.$toast(\"删除成功\");    \r\n          }else{\r\n            this.$toast(\"删除失败\");\r\n          }\r\n        } catch (error) {\r\n          console.log(\"取消\");\r\n        }\r\n      })();\r\n    // }).catch(err=>{\r\n    //   console.log(\"已取消\");\r\n    // });  \r\n    },\r\n    delAll(){\r\n      (async ()=>{\r\n        try{\r\n          await this.$messagebox.confirm(\"确定清空购物车所有商品吗\")\r\n          var res=await this.axios.get(\"delAll\");\r\n          if(res.data.code==-2){\r\n            this.$messagebox(\"\",\"请登录\").then(res=>{\r\n              this.$router.push('/Login');\r\n            });\r\n          }else if(res.data.code==1){\r\n              this.$toast(\"删除成功\");\r\n              this.cart_list=[];\r\n          }else{\r\n              this.$toast(\"删除失败\");\r\n          }\r\n        }catch(err){\r\n          console.log(\"取消\");\r\n        }\r\n      })();\r\n    }\r\n  \r\n  },\r\n  created() {\r\n    this.loadMore(); \r\n  },\r\n  computed:{\r\n    total(){\r\n      if(this.cart_list.length>0){\r\n        return this.cart_list.filter(elem=>elem.isChecked).reduce((prev,elem)=>prev+elem.price*elem.count,0).toFixed(2);\r\n      }\r\n      else{\r\n        return (0).toFixed(2);\r\n      }\r\n    },\r\n    someId(){\r\n      var ids=\"\";\r\n      for (const c of this.cart_list) {\r\n        if(c.isChecked){\r\n          ids+=c.id+\",\";\r\n        }\r\n      }\r\n      // 去掉最后的一个逗号\r\n      ids=ids.slice(0,-1);\r\n      return ids;\r\n      // return this.cart_list.filter(elem=>elem.isChecked).map(elem=>elem.id).join(\",\"); \r\n    }\r\n    // allId(){\r\n    //   return this.cart_list.map(elem=>elem.id);\r\n    // }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  p,h4{\r\n    margin:0;\r\n  }\r\n  .page_cart h2{\r\n    margin:0;\r\n    padding:1rem 0.5rem;\r\n    background-color: lightcoral;\r\n    font-weight: normal;\r\n  }\r\n  .cart_list{\r\n    padding: 0.2rem;\r\n  }\r\n  .cart_list nav{\r\n    width:100%;\r\n    height:2rem;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-around;\r\n    background-color:#eee;\r\n   \r\n  }\r\n  .cart_list .pro{\r\n    width:40%;\r\n  }\r\n  .check{\r\n    width:13%;\r\n  }\r\n  .price{\r\n    width:20%;\r\n  }\r\n  .delete{\r\n    width:14%;\r\n    background-color:transparent;\r\n  }\r\n  .cart_list .cart_item{\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-around;\r\n    margin-bottom: 0.2rem;\r\n    padding:0.3rem 0;\r\n    background-color: #FFF4E8;\r\n  }\r\n  .bottom{\r\n   display: flex;\r\n   justify-content: space-between;\r\n   align-items: center;\r\n   position: fixed;\r\n   bottom: 0;\r\n   width:98%;\r\n   background-color: #fff;\r\n  }\r\n</style>\r\n"]}]}